// ===== ğŸŒ åœ°ç†ä½ç½®æª¢æŸ¥ =====
function checkGeolocationSupport() {
  if ("geolocation" in navigator) {
    console.log("åœ°ç†ä½ç½®æœå‹™å¯ç”¨");
    return true;
  } else {
    console.log("åœ°ç†ä½ç½®æœå‹™ä¸å¯ç”¨");
    return false;
  }
}

// ===== ğŸ“ å–å¾—ä½ç½® =====
function getCurrentLocation() {
  if (!checkGeolocationSupport()) return;

  navigator.geolocation.getCurrentPosition(
    (position) => {
      console.log("ä½ç½®å–å¾—æˆåŠŸ:", position);
      handlePosition(position);
    },
    (error) => {
      console.error("ä½ç½®å–å¾—å¤±æ•—:", error);
    }
  );
}

// ===== ğŸ§­ è™•ç†ä½ç½®è³‡æ–™ =====
function handlePosition(position) {
  const coords = position.coords;
  
  console.log("ç·¯åº¦:", coords.latitude);
  console.log("ç¶“åº¦:", coords.longitude);
  console.log("ç²¾åº¦:", coords.accuracy);
  console.log("æµ·æ‹”:", coords.altitude);
  console.log("æµ·æ‹”ç²¾åº¦:", coords.altitudeAccuracy);
  console.log("æ–¹å‘:", coords.heading);
  console.log("é€Ÿåº¦:", coords.speed);
}

// ===== ğŸ“± æ„Ÿæ¸¬å™¨æ¬Šé™è«‹æ±‚ï¼ˆéƒ¨åˆ†ç€è¦½å™¨éœ€è¦ï¼‰=====
async function requestSensorPermissions() {
  try {
    if (!navigator.permissions) {
      console.log("æ­¤ç€è¦½å™¨ä¸æ”¯æ´ Permissions API");
      return;
    }

    await navigator.permissions.query({ name: 'accelerometer' });
    await navigator.permissions.query({ name: 'gyroscope' });

    console.log("æ„Ÿæ¸¬å™¨æ¬Šé™æŸ¥è©¢å®Œæˆï¼ˆä¸ä¸€å®šä»£è¡¨å·²æˆæ¬Šï¼‰");
  } catch (err) {
    console.log("æ„Ÿæ¸¬å™¨æ¬Šé™è«‹æ±‚å‡ºéŒ¯ï¼š", err);
  }
}

// ===== ğŸš€ åˆå§‹åŒ–ä½¿ç”¨ =====
async function init() {
  await requestSensorPermissions();
  getCurrentLocation();
}

init();
