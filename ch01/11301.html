<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å®šä½ç¤ºç¯„é </title>

<style>
    body {
        font-family: "Microsoft JhengHei", sans-serif;
        background: #e8f8f6; /* Tiffanyç¶ æ·¡è‰² */
        margin: 0;
        padding: 40px 20px;
        color: #333;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    h1 {
        color: #009f9d; /* æ·±ä¸€é»çš„ Tiffany ç¶  */
        margin-bottom: 20px;
    }

    button {
        background-color: #00b3b0; 
        color: white;
        border: none;
        padding: 14px 28px;
        font-size: 1.2rem;
        border-radius: 10px;
        cursor: pointer;
        transition: 0.25s;
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }

    button:hover {
        background-color: #009f9d;
        transform: translateY(-2px);
    }

    #output {
        margin-top: 30px;
        width: 90%;
        max-width: 420px;
        padding: 20px;
        background: white;
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.12);
        line-height: 1.8;
        white-space: pre-line;
    }

    .loading {
        animation: blink 1s infinite;
    }

    @keyframes blink {
        0% { opacity: 1; }
        50% { opacity: 0.45; }
        100% { opacity: 1; }
    }
</style>
</head>

<body>

<h1>ğŸ“ ä½ç½®å–å¾—ç¤ºç¯„</h1>

<button id="getLocationBtn">å–å¾—æˆ‘çš„ä½ç½®</button>
<div id="output">å°šæœªå–å¾—ä½ç½®è³‡è¨Š</div>

<script>
// å…ƒç´ 
const btn = document.getElementById("getLocationBtn");
const output = document.getElementById("output");

// é»æ“Šå–å¾—ä½ç½®
btn.addEventListener("click", () => {
  output.classList.add("loading");
  output.textContent = "å®šä½ä¸­ï¼Œè«‹ç¨å€™...";
  getLocation();
});

// ä¸»å®šä½æµç¨‹ï¼ˆGPS â†’ IP fallbackï¼‰
function getLocation() {
  if ("geolocation" in navigator) {
    navigator.geolocation.getCurrentPosition(
      (pos) => {
        output.classList.remove("loading");
        const { latitude, longitude, accuracy } = pos.coords;
        output.innerHTML =
          `ã€GPS å®šä½æˆåŠŸï¼ˆé«˜ç²¾æº–ï¼‰ã€‘\n\n` +
          `ç·¯åº¦ï¼š${latitude}\n` +
          `ç¶“åº¦ï¼š${longitude}\n` +
          `ç²¾åº¦ï¼šÂ±${accuracy} å…¬å°º`;
      },
      (err) => {
        output.classList.remove("loading");
        console.warn("GPS å¤±æ•—ï¼Œæ”¹ç”¨ IP å®šä½", err);
        fetchByIP();
      },
      { enableHighAccuracy: true, timeout: 6000 }
    );
  } else {
    fetchByIP();
  }
}

// IP fallback
async function fetchByIP() {
  try {
    output.classList.add("loading");
    output.textContent = "GPS å¤±æ•—ï¼Œæ­£åœ¨ä»¥ IP å®šä½...";

    const res = await fetch("https://ipapi.co/json/");
    const data = await res.json();

    output.classList.remove("loading");
    output.innerHTML =
      `ã€IP å®šä½æˆåŠŸï¼ˆè¼ƒä½ç²¾æº–ï¼‰ã€‘\n\n` +
      `åŸå¸‚ï¼š${data.city}\n` +
      `åœ‹å®¶ï¼š${data.country_name}\n` +
      `ç·¯åº¦ï¼š${data.latitude}\n` +
      `ç¶“åº¦ï¼š${data.longitude}\n` +
      `ï¼ˆèª¤å·®å¯èƒ½åå¤§ï¼‰`;
  } catch (error) {
    output.classList.remove("loading");
    output.innerHTML = "å®šä½å¤±æ•—ï¼šç„¡æ³•å–å¾— IP è³‡è¨Š";
  }
}
</script>

</body>
</html>
